<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Building and Creating an Indoor Plant-Care System</title>
  <style>
    body {
      font-family: "Helvetica", Arial, sans-serif;
      max-width: 800px;
      margin: auto;
      background-color: #fafafa;
      color: #222;
      line-height: 1.6;
      padding: 20px;
    }

    h1 {
      color: #210dfd8b;
      border-bottom: 2px solid #ce510dff;
      padding-bottom: 0.2em;
    }

    h2 {
      color: #333;
      margin-top: 1.5em;
    }

    ul, ol {
      margin-left: 1.5em;
    }

    /* Sous-listes dans les √©tapes */
    ol > li ul {
      margin-top: 0.5em;
      margin-bottom: 0.5em;
    }

    ol > li strong {
      color: #444;
      display: block;
      margin-bottom: 0.3em;
    }

    .section {
      margin-bottom: 2em;
      background: #fff;
      padding: 1em;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    /* Styliser le titre principal de chaque √©tape : encadr√© gris et police un peu plus grande
       Cibl√© uniquement dans la section √âtapes (classe .steps) pour √©viter d'impacter d'autres <strong>. */
    .section.steps > ol > li > strong:first-child {
      display: block;
      background: #f3f3f3; /* gris tr√®s clair */
      color: #222;
      padding: 0.45rem 0.6rem;
      border: 1px solid #d6d6d6;
      border-radius: 6px;
      font-size: 1.06em; /* l√©g√®rement plus grand */
      margin-bottom: 0.45rem;
    }

    /* Mat√©riaux: rendre les sous-items gris√©s et en police plus petite */
    .section.materials ul ul {
      color: #666;
      font-size: 0.9em;
      margin-top: 0.35em;
    }

    /* (Step title framed styles were removed per user request to revert) */

    .step-images {
      margin: 1em 0;
      display: grid;
      gap: 0.6rem;
    }

  /* Layout for image boxes: adjust columns based on count via classes .count-N */
  .step-images.count-1 { grid-template-columns: 1fr; }
  .step-images.count-2 { grid-template-columns: repeat(2, 1fr); }
  .step-images.count-3 { grid-template-columns: repeat(3, 1fr); }
  /* For 4 or more images, use 2 columns thumbnail layout for a more harmonious small-preview look */
  .step-images.count-4,
  .step-images.count-5,
  .step-images.count-6,
  .step-images.count-7,
  .step-images.count-8,
  .step-images.count-9,
  .step-images.count-10 { grid-template-columns: repeat(2, 1fr); }

    /* container box around the whole set of images for the step */
    .step-images {
      margin: 1em 0;
      display: grid;
      gap: 0.6rem;
      background: #fafafa; /* subtle gray background */
      border: 1px solid #e6e6e6;
      padding: 0.6rem;
      border-radius: 8px;
    }

    figure {
      margin: 0;
      text-align: center;
      background: transparent;
      padding: 0.25rem 0;
      border-radius: 6px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Thumbnails: show the whole image (no cropping). Use contain with max dims so
       small images display fully while larger images are constrained. Center them. */
    .step-images figure img {
      width: auto;
      max-width: 100%;
      max-height: 160px; /* control thumbnail height but do not crop */
      object-fit: contain; /* show full image */
      background: #f5f5f5; /* subtle neutral background for small images */
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
      cursor: zoom-in;
      display: block;
      margin: 0 auto; /* center narrower images */
    }
    /* Single-image steps: let the image take available width while preserving aspect */
    .step-images.count-1 figure img {
      width: 100%;
      height: auto;
      object-fit: contain;
      max-height: none;
    }

    /* Hide figcaptions in thumbnail/grid mode; captions are shown in the lightbox */
    .step-images figure figcaption { display: none; }

    figcaption {
      font-size: 0.9em;
      color: #666;
      margin-top: 0.5em;
      font-style: italic;
    }
    

    /* Lightbox overlay */
    .lightbox-overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.75);
      z-index: 9999;
      padding: 1rem;
    }
    .lightbox-overlay.active { display: flex; }
    .lightbox-content {
      max-width: 95%;
      max-height: 95%;
      text-align: center;
    }
    .lightbox-content img {
      max-width: 100%;
      max-height: 80vh;
      border-radius: 6px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
    }
    .lightbox-caption { color: #fff; margin-top: 0.6rem; font-size: 0.95em; }
    .lightbox-close {
      position: absolute; top: 12px; right: 16px; color: #fff; background: transparent;
      border: none; font-size: 1.6rem; cursor: pointer;
    }

    footer {
      margin-top: 2em;
      font-size: 0.9em;
      color: #666;
      border-top: 1px solid #ddd;
      padding-top: 1em;
    }

    /* Style impression PDF */
    @media print {
      body { background: white; color: black; }
      a { color: black; text-decoration: none; }
      .section { box-shadow: none; border: 1px solid #ccc; }
    }
  </style>
</head>
<body>

  <header>
    <h1>Building and Creating an Indoor Plant-Care System</h1>
    
      <div style="text-align:center; margin-bottom:1.2em;">
        <img src="https://content.instructables.com/F0N/UEUF/LZ9UY04E/F0NUEUFLZ9UY04E.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75" alt="Image principale du tutoriel" style="max-width:100%; max-height:320px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08);">
        
      </div>
    
    
      
        <p>Welcome to the Plant-Care System project! This comprehensive guide will walk you through creating an intelligent plant monitoring and care system. This project combines hardware and software to automate plant care, ensuring your plants receive the optimal conditions for growth.</p>
      
        <p>By the end of this guide, you will have a fully functional plant-care system that can monitor environmental conditions, log data for analysis, and automate care tasks such as watering and lighting. Let's get started on this exciting journey to create a smarter way to care for your plants!</p>
      
        <p>Here is a link to a video fully describing the system and its functionality: https://drive.google.com/file/d/1Olfpx7ve-IT3-vYND8_gT_AxlabPyn4j/view?usp=share_link</p>
      
    
    
  </header>

  <div class="section materials">
    <h2>üõ†Ô∏è Mat√©riaux</h2>
    
      <ul>
        <li>Supplies<ul><li>ESP32 microcontroller</li><li>Soil moisture sensor</li><li>Water level sensor</li><li>LED strip (individually addressable)</li><li>Servo motor</li><li>Breadboard and jumper wires</li><li>Power supply</li></ul></li>
      </ul>
    
  </div>

  <div class="section">
    <h2>üîß Outils</h2>
    
      <p><em>Non sp√©cifi√©</em></p>
    
  </div>

  <div class="section steps">
    <h2> √âtapes</h2>
    
      <ol>
        
          <li>
            
            
              <strong>1. Step 1: Install Blynk App</strong><p><strong>√âtapes :</strong></p><ol><li><ul><li>Download and install the Blynk app on your smartphone.</li><li>Create a Blynk account if you don‚Äôt have one.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>2. Step 2: Create a New Blynk Project</strong><p><strong>√âtapes :</strong></p><ol><li><ul><li>Open the Blynk app and create a new project.</li><li>Select ESP32 as the device and WiFi as the connection type.</li><li>Copy the Auth Token provided by Blynk and paste it into your Arduino code.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>3. Step 3: Add Widgets to the Dashboard and Configure Them</strong><div class='step-images count-2'><figure><img src='https://content.instructables.com/FHM/O2I5/LZ9UY03I/FHMO2I5LZ9UY03I.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add Widgets to the Dashboard and Configure Them' loading='lazy'></figure><figure><img src='https://content.instructables.com/FHM/O2I5/LZ9UY03I/FHMO2I5LZ9UY03I.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add Widgets to the Dashboard and Configure Them' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Add a Gauge widget for soil moisture and link it to Virtual Pin V1.</li><li>Add a Gauge widget for water level and link it to Virtual Pin V4.</li><li>Add a Button widget for manual watering and link it to Virtual Pin V3.</li><li>Add a Button widget for manual LED control and link it to Virtual Pin V5.</li><li>Add a Button widget for mode selection (manual/automatic) and link it to Virtual Pin V2.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>4. Step 4: Create a Make.com Account</strong><p><strong>√âtapes :</strong></p><ol><li><ul><li>Go to Make.com and sign up for an account if you don‚Äôt have one.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>5. Step 5: Create a New Scenario:</strong><p><strong>√âtapes :</strong></p><ol><li><ul><li>From the dashboard, click on "Create a new scenario".</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>6. Step 6: Add a Webhook Module</strong><div class='step-images count-2'><figure><img src='https://content.instructables.com/FTI/AT21/LZ9UY03S/FTIAT21LZ9UY03S.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add a Webhook Module' loading='lazy'></figure><figure><img src='https://content.instructables.com/FTI/AT21/LZ9UY03S/FTIAT21LZ9UY03S.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add a Webhook Module' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Search for "Webhook" and select "Custom Webhook".</li><li>Click "Add" to create a new Webhook.</li><li>Name your webhook (e.g., "PlantMonitorDataWebhook") and copy the provided Webhook URL.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>7. Step 7: Configure the Webhook Module</strong><p><strong>√âtapes :</strong></p><ol><li><ul><li>Set the Webhook to capture all necessary fields.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>8. Step 8: Add a Telegram Bot Module</strong><div class='step-images count-4'><figure><img src='https://content.instructables.com/FX0/E4YC/LZ9UY03Y/FX0E4YCLZ9UY03Y.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add a Telegram Bot Module' loading='lazy'></figure><figure><img src='https://content.instructables.com/FR0/41CT/LZ9UY045/FR041CTLZ9UY045.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add a Telegram Bot Module' loading='lazy'></figure><figure><img src='https://content.instructables.com/FX0/E4YC/LZ9UY03Y/FX0E4YCLZ9UY03Y.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add a Telegram Bot Module' loading='lazy'></figure><figure><img src='https://content.instructables.com/FR0/41CT/LZ9UY045/FR041CTLZ9UY045.png?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Add a Telegram Bot Module' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Search for "Telegram" and select the appropriate action (e.g., "Send a message").</li><li>Connect your Telegram account and configure the message content based on the incoming data.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>9. Step 9: Save and Test the Scenario</strong><p><strong>√âtapes :</strong></p><ol><li><ul><li>Run the scenario once to ensure it is set up correctly.</li><li>Verify that the data is correctly logged and notifications are sent as expected.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>10. Step 10: Writing the Code</strong><div class='step-images count-2'><figure><img src='https://content.instructables.com/F4A/OVQI/LZ9UY03H/F4AOVQILZ9UY03H.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Writing the Code' loading='lazy'></figure><figure><img src='https://content.instructables.com/F4A/OVQI/LZ9UY03H/F4AOVQILZ9UY03H.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Writing the Code' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Set Up the Development Environment:</li><li>Install Arduino IDE.</li><li>Install necessary libraries in Arduino IDE: Blynk, FastLED, ESP32Servo, and HTTPClient.</li><li>Write the Code:</li><li>Define WiFi credentials and Blynk credentials.</li><li>Set up pin definitions for soil moisture sensor, water level sensor, LED strip, and servo motor.</li><li>Implement functions to read sensor data, control the LED strip, and water the plant.</li><li>Implement Blynk virtual pin handlers for mode selection and manual control.</li><li>Ensure the code periodically reads sensor data, updates the Blynk dashboard, and performs actions based on sensor readings and mode.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>11. Step 11: Upload the Code</strong><div class='step-images count-2'><figure><img src='https://content.instructables.com/F7Z/QVT8/LZ9UY06H/F7ZQVT8LZ9UY06H.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Upload the Code' loading='lazy'></figure><figure><img src='https://content.instructables.com/F7Z/QVT8/LZ9UY06H/F7ZQVT8LZ9UY06H.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Upload the Code' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Connect the ESP32 to your computer via USB.</li><li>Select the correct board and port in Arduino IDE.</li><li>Upload the code to the ESP32.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>12. Step 12: Physically Building the System</strong><p><strong>√âtapes :</strong></p><ol><li>Gather Components:<ul><li>ESP32 microcontroller</li><li>Soil moisture sensor</li><li>Water level sensor</li><li>LED strip (individually addressable)</li><li>Servo motor</li><li>Breadboard and jumper wires</li><li>Power supply</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>13. Step 13: Connect the Components</strong><div class='step-images count-10'><figure><img src='https://content.instructables.com/F6V/POSH/LZ9UY04N/F6VPOSHLZ9UY04N.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/FAG/OI55/LZ9UY04X/FAGOI55LZ9UY04X.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/FQM/YB3R/LZ9UY04Z/FQMYB3RLZ9UY04Z.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/F9V/0VY2/LZ9UY05A/F9V0VY2LZ9UY05A.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/FKY/0UD8/LZ9UY061/FKY0UD8LZ9UY061.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/F6V/POSH/LZ9UY04N/F6VPOSHLZ9UY04N.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/FAG/OI55/LZ9UY04X/FAGOI55LZ9UY04X.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/FQM/YB3R/LZ9UY04Z/FQMYB3RLZ9UY04Z.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/F9V/0VY2/LZ9UY05A/F9V0VY2LZ9UY05A.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure><figure><img src='https://content.instructables.com/FKY/0UD8/LZ9UY061/FKY0UD8LZ9UY061.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Connect the Components' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Soil Moisture Sensor:</li><li>Connect the VCC pin to the 3.3V pin on the ESP32.</li><li>Connect the GND pin to the GND pin on the ESP32.</li><li>Connect the signal pin to an analog pin (e.g., GPIO 35) on the ESP32.</li><li>Water Level Sensor:</li><li>Connect the VCC pin to the 3.3V pin on the ESP32.</li><li>Connect the GND pin to the GND pin on the ESP32.</li><li>Connect the signal pin to an analog pin (e.g., GPIO 34) on the ESP32.</li><li>LED Strip:</li><li>Connect the power and ground lines to the appropriate power supply (e.g., 5V and GND).</li><li>Connect the data line to a digital pin (e.g., GPIO 26) on the ESP32.</li><li>Servo Motor:</li><li>Connect the VCC pin to the 3V pin on the ESP32 (or an external 5V power source).</li><li>Connect the GND pin to the GND pin on the ESP32.</li><li>Connect the control signal pin to a PWM-capable pin (e.g., GPIO 33) on the ESP32.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>14. Step 14: Power Up the System</strong><div class='step-images count-2'><figure><img src='https://content.instructables.com/FS9/NEQX/LZ9UY1BP/FS9NEQXLZ9UY1BP.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Power Up the System' loading='lazy'></figure><figure><img src='https://content.instructables.com/FS9/NEQX/LZ9UY1BP/FS9NEQXLZ9UY1BP.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Power Up the System' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Connect the ESP32 to a power source.</li><li>Ensure all sensors and components are properly powered.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>15. Step 15: Test the System</strong><div class='step-images count-2'><figure><img src='https://content.instructables.com/FOL/6UB8/LZ9UY1DT/FOL6UB8LZ9UY1DT.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Test the System' loading='lazy'></figure><figure><img src='https://content.instructables.com/FOL/6UB8/LZ9UY1DT/FOL6UB8LZ9UY1DT.jpg?auto=webp&fit=bounds&frame=1auto=webp&frame=1&height=300&auto=webp&fit=bounds&width=600&height=450&quality=75' alt='Test the System' loading='lazy'></figure></div><p><strong>√âtapes :</strong></p><ol><li><ul><li>Verify that the ESP32 connects to WiFi and the Blynk app.</li><li>Check that sensor data is read correctly and displayed on the Blynk dashboard.</li><li>Test the manual control features and automatic mode functionality.</li></ul></li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
          <li>
            
            
              <strong>16. Step 16: Summary</strong><p><strong>√âtapes :</strong></p><ol><li>By following these steps, you will successfully build and create the plant-care system, complete with code implementation, Blynk dashboard, Make.com scenario for data logging and notifications, and physical assembly of the system with sensors and components. Enjoy!!</li></ol>
            

            
            
            
              
              
                
                
                
              

              
            
          </li>
        
      </ol>
    
  </div>

  

  <!-- Lightbox overlay for viewing images -->
  <div id="lightbox" class="lightbox-overlay" aria-hidden="true">
    <button id="lb-close" class="lightbox-close" aria-label="Fermer">√ó</button>
    <!-- Prev/Next visible controls -->
    <button id="lb-prev" class="lightbox-control lightbox-prev" aria-label="Image pr√©c√©dente">‚Äπ</button>
    <button id="lb-next" class="lightbox-control lightbox-next" aria-label="Image suivante">‚Ä∫</button>
    <div class="lightbox-content">
      <img id="lb-img" src="" alt="">
      <div id="lb-caption" class="lightbox-caption"></div>
    </div>
  </div>

  <script>
    // JS lightbox: delegate clicks from step-images figures
    document.addEventListener('click', function(ev){
      const fig = ev.target.closest('.step-images figure');
      if(!fig) return;
      const container = fig.closest('.step-images');
      if(!container) return;
      const figures = Array.from(container.querySelectorAll('figure'));
      const idx = figures.indexOf(fig);
      if(idx < 0) return;

      const overlay = document.getElementById('lightbox');
      const imgEl = document.getElementById('lb-img');
      const captionEl = document.getElementById('lb-caption');
      const btnPrev = document.getElementById('lb-prev');
      const btnNext = document.getElementById('lb-next');

      let current = idx;
      function show(i){
        const f = figures[i];
        const im = f.querySelector('img');
        const cap = f.querySelector('figcaption');
        if(im){ imgEl.src = im.src; imgEl.alt = im.alt || ''; }
        captionEl.textContent = cap ? cap.textContent : '';
        overlay.classList.add('active');
        overlay.setAttribute('aria-hidden','false');
      }
      function hide(){ overlay.classList.remove('active'); overlay.setAttribute('aria-hidden','true'); }

      show(current);

      // close handlers
      document.getElementById('lb-close').onclick = hide;
      overlay.onclick = function(e){ if(e.target === overlay) hide(); };
      // prev/next click handlers
      if(btnPrev){ btnPrev.onclick = function(e){ e.stopPropagation(); current = Math.max(current-1, 0); show(current); }; }
      if(btnNext){ btnNext.onclick = function(e){ e.stopPropagation(); current = Math.min(current+1, figures.length-1); show(current); }; }
      document.onkeydown = function(e){
        if(e.key === 'Escape') hide();
        if(e.key === 'ArrowRight') { current = Math.min(current+1, figures.length-1); show(current); }
        if(e.key === 'ArrowLeft') { current = Math.max(current-1, 0); show(current); }
      };
    });
  </script>

  <style>
    /* lightbox visible controls styling */
    .lightbox-control {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.35);
      color: #fff;
      border: none;
      width: 44px;
      height: 70px;
      font-size: 2rem;
      line-height: 1;
      border-radius: 6px;
      cursor: pointer;
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }
    .lightbox-prev { left: 12px; }
    .lightbox-next { right: 12px; }
    .lightbox-control:hover { background: rgba(0,0,0,0.6); }
    @media (max-width: 600px){ .lightbox-control { width: 36px; height: 56px; font-size: 1.6rem; } }
  </style>

  

</body>
</html>